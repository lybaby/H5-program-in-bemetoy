/*! 09-05-2016 */
define("page/albumindex",["comm/utils","comm/url","comm/request","comm/unveil","helper/app","require","exports"],function(a,b,c,d,e,f,g){"use strict";var h=function(b){if(b.classify)if(b.classify.name)e.setTitle(b.classify.name);else{var c=["其他","0-24个月","2-3岁","3-4岁","4-5岁","5岁以上"];e.setTitle(c[b.classify.age])}else e.setTitle("全部专辑");$("#song_num").html(b.count),$("#album_num").html(b.album_num);var d=a.template("J_temp-albumitem",{list:b.album});$("#album_list").html(d),$("img.lazy").unveil(),e.backScroll()},i=function(a,b){c.getLocalRequest({url:BEME.APIURL+"/albums/albumTagsPage",data:{tag_id:a,classify_age:b,page:1},successfn:function(a){e.loaded(),0===a.code&&h(a.data)}})},j=function(){$("#album_list").append('<div class="pageloading"><span>正在加载...</span></div>')},k=function(){$(".pageloading").remove()},l=function(b,d,e){j(),o=!0,c.getRequest({url:BEME.APIURL+"/albums/albumTagsPage",data:{tag_id:b,classify_age:d,page:e},successfn:function(b){if(k(),0===b.code){var c=a.template("J_temp-albumitem",{list:b.data.album});$("#album_list").append(c),$("img.lazy").unveil()}o=!1}})},m=0,n=1,o=!1,p=function(a,b){window.onscroll=function(){var c=document.body.scrollTop,d=document.body.clientHeight,e=document.body.scrollHeight;30>e-(c+d)&&e>m&&!o&&(n+=1,m=e,l(a,b,n))}};g.init=function(){var c=b.getParams(),d=["其他","0-24个月","2-3岁","3-4岁","4-5岁","5岁以上"];e.setTitle(d[c.age]),$(".back-btn").show(),a.headerMenu(),$("#myplay").show(),e.showHeader(),i(c.id,c.age),m=0,n=1,p(c.id,c.age)},g.uninit=function(){window.onscroll=null}});