/*! 09-05-2016 */
define("page/ranking",["comm/utils","comm/url","comm/request","comm/pushsong","comm/swipe","comm/clickevent","helper/app","helper/playerbar","page/myalbum","require","exports"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l={},m=function(b){$("#J_songnum").text(b.length);var c=a.template("J_temp-item",{list:b});$("#J_song-box").html(c),$.each(b,function(a,b){b._type="ranking",l[b.id]=b}),g.backScroll()},n=function(){c.getRequest({url:BEME.APIURL+"/ranking/getAllTag",successfn:function(b){if(0===b.code){b.data.splice(0,0,{id:0,name:"全部分类"});var c=a.template("J_temp-cate",{list:b.data});$("#J_cate-box").html(c),$("#J_top-box").Swipe({continuous:!1,callback:function(a){$("#J_cate-box .menu-list").eq(a).find(".item-a").eq(0).click()}}),$("#J_cate-box .menu-list").eq(0).find(".item-a").eq(0).click()}}})},o=function(a){c.getRequest({url:BEME.APIURL+"/ranking/rankingList?classify_id="+a,successfn:function(a){g.loaded(),0===a.code?m(a.data):($("#J_song-box").html(""),$("#J_songnum").text("0"))}})},p=function(){$("#J_cate-box").on("click",".item-a",function(){var a=$(this),b=a.data("id");o(b),$("#J_cate-box li").removeClass("cur"),a.parent().addClass("cur")}),$("#J_song-box").on("click",".item .item-a",function(){f.pushSong(this)}),$(".caction-box").on("click",".play-btn",function(){f.pushAllSong(this)}),$("#J_song-box").on("click",".item-play",function(){var a=$(this).parent(),b=a.attr("sid");h.initPlayer(a,l[+b])})};k.init=function(){g.setTitle("点播排行"),$(".back-btn").show(),a.headerMenu(),$("#myplay").show();b.getParams();g.showHeader(),p(),n()},k.uninit=function(){$("#J_cate-box, #J_song-box").off("click")}});