/*! 09-05-2016 */
define("helper/jrange",[],function(){"use strict";var a=0,b=function(){return this.init.apply(this,arguments)};b.prototype={defaults:{onstatechange:function(){},ondragchange:function(){},isRange:!1,showLabels:!0,showScale:!0,step:1,format:"%s",theme:"theme-green",width:300,disable:!1},template:['<div class="slider-container">','<div class="back-bar">','<div class="selected-bar"></div>','<div class="pointer low"></div><div class="pointer-label"></div>','<div class="pointer high btn-play btn-single"></div><div class="pointer-label"></div>','<div class="clickable-dummy"></div>','<div class="load-bar" />',"</div>",'<div class="scale"></div>',"</div>"].join(""),init:function(a,b){this.options=$.extend({},this.defaults,b),this.inputNode=$(a),this.options.value=this.inputNode.val()||(this.options.isRange?this.options.from+","+this.options.from:this.options.from),this.domNode=$(this.template),this.domNode.addClass(this.options.theme),this.inputNode.after(this.domNode),this.domNode.on("change",this.onChange),this.pointers=$(".pointer",this.domNode),this.lowPointer=this.pointers.first(),this.highPointer=this.pointers.last(),this.labels=$(".pointer-label",this.domNode),this.lowLabel=this.labels.first(),this.highLabel=this.labels.last(),this.scale=$(".scale",this.domNode),this.bar=$(".selected-bar",this.domNode),this.clickableBar=this.domNode.find(".clickable-dummy"),this.interval=this.options.to-this.options.from,this.render()},render:function(){return 0!==this.inputNode.width()||this.options.width?(this.domNode.width(this.options.width||this.inputNode.width()),this.inputNode.hide(),this.isSingle()&&(this.lowPointer.hide(),this.lowLabel.hide()),this.options.showLabels||this.labels.hide(),this.attachEvents(),this.options.showScale&&this.renderScale(),void this.setValue(this.options.value)):void console.log("jRange : no width found, returning")},isSingle:function(){return"number"==typeof this.options.value?!0:-1!==this.options.value.indexOf(",")||this.options.isRange?!1:!0},attachEvents:function(){this.clickableBar.click($.proxy(this.barClicked,this)),this.pointers.on("mousedown touchstart",$.proxy(this.onDragStart,this)),this.pointers.bind("dragstart",function(a){a.preventDefault()})},onDragStart:function(b){if(!(this.options.disable||"mousedown"===b.type&&1!==b.which)){a=b.timeStamp,b.stopPropagation(),b.preventDefault();var c=$(b.target);this.pointers.removeClass("last-active"),c.addClass("focused last-active"),this[(c.hasClass("low")?"low":"high")+"Label"].addClass("focused"),$(document).on("mousemove.slider touchmove.slider",$.proxy(this.onDrag,this,c)),$(document).on("mouseup.slider touchend.slider touchcancel.slider",$.proxy(this.onDragEnd,this))}},onDrag:function(a,b){b.stopPropagation(),b.preventDefault(),b.touches&&b.touches.length?b=b.touches[0]:b.changedTouches&&b.changedTouches.length&&(b=b.changedTouches[0]);var c=b.clientX-this.domNode.offset().left;this.domNode.trigger("change",[this,a,c])},onDragEnd:function(b){b.stopPropagation(),b.preventDefault();var c=b.timeStamp-a;200>c&&$(this.bar[0]).parent().parent().parent().parent().find(".btn-play").click(),this.pointers.removeClass("focused"),this.labels.removeClass("focused"),$(document).off(".slider")},barClicked:function(a){if(!this.options.disable){var b=0,c=a.pageX-this.clickableBar.offset().left;this.isSingle()?(b=this.pointers.last(),this.setPosition(b,c,!0,!0)):(b=Math.abs(parseInt(this.pointers.first().css("left"),10)-c+this.pointers.first().width()/2)<Math.abs(parseInt(this.pointers.last().css("left"),10)-c+this.pointers.first().width()/2)?this.pointers.first():this.pointers.last(),this.setPosition(b,c,!0,!0));var d=a.clientX-this.domNode.offset().left;this.domNode.trigger("change",[this,b,d])}},onChange:function(a,b,c,d){var e,f;b.isSingle()?(e=0,f=b.domNode.width()):(e=c.hasClass("high")?b.lowPointer.position().left+b.lowPointer.width()/2:0,f=c.hasClass("low")?b.highPointer.position().left+b.highPointer.width()/2:b.domNode.width());var g=Math.min(Math.max(d,e),f);b.setPosition(c,g,!0),b.options.ondragchange.call(b,b.options.value)},setPosition:function(a,b,c,d){var e,f=this.lowPointer.position().left,g=this.highPointer.position().left,h=this.highPointer.width()/2;c||(b=this.prcToPx(b)),a[0]===this.highPointer[0]?g=Math.round(b-h):f=Math.round(b-h),0==h&&(h=14),d=!1,a[d?"animate":"css"]({left:Math.round(b-h)}),e=this.isSingle()?0:f+h,this.bar[d?"animate":"css"]({width:Math.round(g+h-e),left:e}),this.showPointerValue(a,b,d),this.isReadonly()},setValue:function(a){var b=a.toString().split(",");this.options.value=a;var c=this.valuesToPrc(2===b.length?b:[0,b[0]]);this.isSingle()?this.setPosition(this.highPointer,c[1]):(this.setPosition(this.lowPointer,c[0]),this.setPosition(this.highPointer,c[1]))},renderScale:function(){for(var a=this.options.scale||[this.options.from,this.options.to],b=Math.round(100/(a.length-1)*10)/10,c="",d=0;d<a.length;d++)c+='<span style="left: '+d*b+'%">'+("|"!=a[d]?"<ins>"+a[d]+"</ins>":"")+"</span>";this.scale.html(c),$("ins",this.scale).each(function(){$(this).css({marginLeft:-$(this).width()/2})})},getBarWidth:function(){var a=this.options.value.split(",");return a.length>1?parseInt(a[1],10)-parseInt(a[0],10):parseInt(a[0],10)},showPointerValue:function(a,b,c){var d,e=$(".pointer-label",this.domNode)[a.hasClass("low")?"first":"last"](),f=this.positionToValue(b);if($.isFunction(this.options.format)){var g=this.isSingle()?void 0:a.hasClass("low")?"low":"high";d=this.options.format(f,g)}else d=this.options.format.replace("%s",f);var h=e.html(d).width(),i=b-h/2;i=Math.min(Math.max(i,0),this.options.width-h),e[c?"animate":"css"]({left:i}),this.setInputValue(a,f)},valuesToPrc:function(a){var b=100*(a[0]-this.options.from)/this.interval,c=100*(a[1]-this.options.from)/this.interval;return[b,c]},prcToPx:function(a){return this.domNode.width()*a/100},positionToValue:function(a){var b=a/this.domNode.width()*this.interval;return b+=this.options.from,Math.round(b/this.options.step)*this.options.step},setInputValue:function(a,b){if(this.isSingle())this.options.value=b.toString();else{var c=this.options.value.split(",");a.hasClass("low")?this.options.value=b+","+c[1]:this.options.value=c[0]+","+b}this.inputNode.val()!==this.options.value&&(this.inputNode.val(this.options.value),this.options.onstatechange.call(this,this.options.value))},getValue:function(){return this.options.value},isReadonly:function(){this.domNode.toggleClass("slider-readonly",this.options.disable)},disable:function(){this.options.disable=!0,this.isReadonly()},enable:function(){this.options.disable=!1,this.isReadonly()},toggleDisable:function(){this.options.disable=!this.options.disable,this.isReadonly()}};var c="jRange";$.fn[c]=function(a){var d,e=arguments;return this.each(function(){var f=$(this),g=f.data("plugin_"+c),h="object"==typeof a&&a;g||(f.data("plugin_"+c,g=new b(this,h)),$(window).resize(function(){g.setValue(g.getValue())})),"string"==typeof a&&(d=g[a].apply(g,Array.prototype.slice.call(e,1)))}),d||this}});