/*! 09-05-2016 */
define("minpage/bemebearindex",["comm/utils","comm/url","helper/playerbar","comm/request","comm/clickevent","helper/app","helper/temphtml","helper/jrange","require","exports"],function(a,b,c,d,e,f,g,h,i,j){"use strict";var k={title:"贝美童趣馆",desc:"小囧熊英文乐园",link:location.href,imgUrl:"专辑图片放进来"},l=function(b,c){var d=$(".bear-page");d.find(".banner .img-cover").attr("src",b.url);var e=f.getUA(0);1==e&&($(".main-header").show(),$(".main-header .back-btn").show(),$("#J_wrapper").css("padding","1.1rem 0 0 0"),$(".sub").hide());var g=f.getUA(1);if(e>1&&g>0&&$(".share_weixin").show(),1==c&&($(".share_weixin").hide(),$(".push-song").hide()),k.imgUrl=b.url,b.album){$.each(b.album,function(a,b){1==c?b.id="#!m=weixin&id="+b.id+"&type=album":b.id="#!m=albuminfo&id="+b.id});var h=a.template("J_temp-item-album",{list:b.album});$("#album_list").html(h)}if(1==c)var c=i(["minpage/weixin"],function(a){a.getWeixinConfig(k)});f.backScroll()},m=function(a,b,c){$.each(a.list,function(a,b){b.content="第"+b.sequence+"期："+b.sub_name,b.question=j.changeDate(b.update_time),1==c&&(b.id=b.id+"&weixin=1")});var d="";d=j.changeDate(a.list[0].update_time)+"最新期——"+a.list[0].sub_name,$("#new-title").text(d),$(".title-box").attr("value",a.list[0].id),n(a.list.slice(0,5).reverse(),c);for(var e=parseInt(a.count/10),f=(a.count%10,""),g=0;e>g;g++)f+=g/3==0?'<li><a class="selected" style="margin:0;" value='+(g+1)+" type="+b+">第"+g+"1-"+(g+1)+"0期</a></li>":g/3==2?'<li><a class="selected" style="margin:0;float:right;" value='+(g+1)+" type="+b+">第"+g+"1-"+(g+1)+"0期</a></li>":'<li><a  class="selected" style="margin:0;" value='+(g+1)+" type="+b+">第"+g+"1-"+(g+1)+"0期</a></li>";f+='<li><a class="selected" style="margin:0;" value='+(g+1)+" type="+b+">第"+(10*e+1)+"-"+a.count+"期</a></li>",$(".page-list").html(f),$(".page-list li").on("click",function(){var a=$(this).find("a").attr("value"),b=$(this).find("a").attr("type");$(this).parent().find("a").addClass("selected"),$(this).find("a").removeClass("selected"),o(b,a,c)})},n=function(b,c){$.each(b,function(a,b){b.content="第"+b.sequence+"期："+b.sub_name,b.question=j.changeDate(b.update_time),1==c&&(b.id=b.id+"&weixin=1")});var d=a.template("J_temp-item",{list:b.reverse()});$("#J_list-box").html(d)},o=function(a,b,c){d.getRequest({url:BEME.APIURL+"/ip/ipList",data:{type:a,page:b},successfn:function(a){f.loaded(),0===a.code&&n(a.data.list,c)}})},p=function(a,b){d.getLocalRequest({url:BEME.APIURL+"/ip/ipClass?type="+a,successfn:function(a){f.loaded(),0===a.code&&l(a.data,b)}}),d.getLocalRequest({url:BEME.APIURL+"/ip/ipList",data:{type:a},successfn:function(c){f.loaded(),0===c.code&&m(c.data,a,b)}})};j.changeDate=function(a){var b=new Date(a),c=b.getMonth()+1+"月"+b.getDate()+"日 ";return c};var q=function(a){$("#play-music").on("click",".music-list .push-song",function(){e.pushSong($(this).parent())}),$(".title-box").on("click",function(){var a=$(this).attr("value"),b="?m=bemebearinfo&id="+a+"&type=2";window.location.href=b}),$(".play-other").on("click",".show-list",function(){var a=$("#J_list-box").find(".list");a.hasClass("hide-all")?(a.removeClass("hide-all"),a.addClass("show-all"),$(".play-other .show-list").removeClass("show-list-down"),$(".play-other .show-list").addClass("show-list-up")):(a.removeClass("show-all"),a.addClass("hide-all"),$(".play-other .show-list").addClass("show-list-down"),$(".play-other .show-list").removeClass("show-list-up"))}),$(".share_weixin").on("click",function(){e.shareToWeixin(a,"ip","ipindex")}),$(".show-preson").on("click",function(){$(".show-preson").hide(),$(".show-hide-all").show()}),$(".hide-preson").on("click",function(){$(".show-preson").show(),$(".show-hide-all").hide()})};j.init=function(){f.setTitle("小囧熊英文乐园");var a=b.getParams();p(a.type,a.weixin),f.hideAllBox(),q(a.type)},j.uninit=function(){$("#play-music").off("click")}});