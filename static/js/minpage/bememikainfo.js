/*! 09-05-2016 */
define("minpage/bememikainfo",["comm/utils","comm/url","helper/playerbar","page/bemeipindex","comm/request","comm/clickevent","helper/app","require","exports"],function(a,b,c,d,e,f,g,h,i){"use strict";var j={title:"贝美童趣馆",desc:"米卡分龄教育",link:location.href,imgUrl:"专辑图片放进来"},k=function(b,e){var f=$(".mika-info-page"),i=a.template("J_temp-mika-song",{list:b.song});$("#play-music").html(i);var k=g.getUA(0);1==k&&($(".main-header").show(),$(".main-header .back-btn").show(),$("#J_wrapper").css("padding","1.1rem 0 0 0"),$(".sub").hide()),1==e&&($(".share_weixin").hide(),$(".push-song").hide());var l=g.getUA(1);k>1&&l>0&&$(".share_weixin").show(),f.find(".problem").html(b.question),f.find(".answer").html(b.answer);var m="";m="第"+b.sequence+"期："+b.sub_name;var n=d.changeDate(b.update_time)+"更新";$("#new-title").text(m),$("#new-day").text(n),j.desc="《米卡分龄教育》"+b.name,j.imgUrl=b.url;var o=f.find(" .music-list");if(1==e?(c.initIpIndexPlay(o,b.song[0],3),$(".push-mika-song").hide()):c.initIpIndexPlay(o,b.song[0],5),1==e)var e=h(["minpage/weixin"],function(a){a.getWeixinConfig(j)});f.find(".play-video").html(b.video_url),f.find(".play-video").find("video").attr("poster",b.url),g.backScroll()},l=function(a,b,c,d){$.each(a.list,function(a,b){b.content="第"+b.sequence+"期："+b.sub_name,b.question=i.changeDate(b.update_time),1==c&&(b.id=b.id+"&weixin=1")}),m(a.list,c);for(var e=parseInt(a.count/10),f=a.count%10,g="",h=0;e>h;h++)g+=h%3==0?'<li><a  style="margin:0;" value='+(h+1)+" type=3>第"+h+"1-"+(h+1)+"0期</a></li>":h%3==1?'<li style="margin: 0 5%;"><a style="margin:0;" value='+(h+1)+" type=3>第"+h+"1-"+(h+1)+"0期</a></li>":'<li><a  style="margin:0;" value='+(h+1)+" type=3>第"+h+"1-"+(h+1)+"0期</a></li>";2==f?g+='<li style="margin:0 5%;"><a style="margin:0;" value='+(h+1)+" type=3>第"+(10*e+1)+"-"+a.count+"期</a></li>":1==f&&(g+='<li><a style="margin:0;" value='+(h+1)+" type=3>第"+(10*e+1)+"-"+a.count+"期</a></li>"),$(".page-list").html(g),$(".page-list li").on("click",function(){var a=$(this).find("a").attr("value"),b=$(this).find("a").attr("type");$(this).parent().find("a").removeClass("selected"),$(this).find("a").addClass("selected"),n(b,a,c)})},m=function(b,c){$.each(b,function(a,b){b.content="第"+b.sequence+"期："+b.sub_name+"（"+b.classify_name+"）",b.question=i.changeDate(b.update_time),1==c&&(b.id=b.id+"&weixin=1")});var d=a.template("J_temp-item",{list:b});$("#J_list-box").html(d)};i.changeDate=function(a){var b=new Date(a),c=b.getMonth()+1+"月"+b.getDate()+"日 ";return c};var n=function(a,b,c){e.getRequest({url:BEME.APIURL+"/ip/mikaPage",data:{type:a,page:b},successfn:function(a){g.loaded(),0===a.code&&m(a.data.list.reverse(),c)}})},o=function(a,b,c){e.getRequest({url:BEME.APIURL+"/ip/mikaPage",data:{page:0},successfn:function(b){g.loaded(),0===b.code&&l(b.data,a,c,!1)}}),e.getRequest({url:BEME.APIURL+"/ip/mikaInfo?id="+a,successfn:function(a){g.loaded(),0===a.code&&k(a.data,c)}}),1==c?$(".back-index").attr("href","?m=bememikaindex&weixin=1&type="+b):$(".back-index").attr("href","?m=bememikaindex&type="+b)},p=function(a,b){$("#play-music").on("click",".music-list .push-mika-song",function(){f.pushSong($(this))}),window.onscroll=function(){$(".title-box").offset().top,$("#bear-song-list").offset().top,$(window).scrollTop()},$(".share_weixin").on("click",function(){f.shareToWeixin(a,"ip","ipinfo",3)}),$(".bear-table").on("click","td",function(){var a=$(this).attr("href");window.location.href=a})};i.init=function(){g.setTitle("米卡分龄教育");var a=b.getParams();o(a.id,a.type,a.weixin),g.hideAllBox(),p(a.id,a.weixin)},i.uninit=function(){$("#play-music").off("click"),window.onscroll=null}});