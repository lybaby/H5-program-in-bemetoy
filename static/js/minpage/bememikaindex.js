/*! 09-05-2016 */
define("minpage/bememikaindex",["comm/utils","comm/url","helper/playerbar","comm/request","comm/clickevent","helper/app","require","exports"],function(a,b,c,d,e,f,g,h){"use strict";var i={title:"贝美童趣馆",desc:"米卡分龄教育",link:location.href,imgUrl:"专辑图片放进来"},j=function(b,c){var d=$(".mika-info-page");d.find(".banner .img-cover").attr("src",b.url);var e=f.getUA(0);1==e&&($(".main-header").show(),$(".main-header .back-btn").show(),$("#J_wrapper").css("padding","1.1rem 0 0 0"));var h=f.getUA(1);e>1&&h>0&&$(".share_weixin").show(),1==c&&$(".share_weixin").hide(),i.imgUrl=b.url;var j=a.template("J_temp-item-classify",{list:b.classifys});if($(".classify-list").html(j),1==c)var c=g(["minpage/weixin"],function(a){a.getWeixinConfig(i)});f.backScroll()},k=function(a,b,c){l(a.list,c);for(var d=parseInt(a.count/10),e=a.count%10,f="",g=0;d>g;g++)f+=g%3==0?'<li><a  style="margin:0;" value='+(g+1)+" type=3>第"+g+"1-"+(g+1)+"0期</a></li>":g%3==1?'<li style="margin: 0 5%;"><a style="margin:0;" value='+(g+1)+" type=3>第"+g+"1-"+(g+1)+"0期</a></li>":'<li><a  style="margin:0;" value='+(g+1)+" type=3>第"+g+"1-"+(g+1)+"0期</a></li>";2==e?f+='<li style="margin:0 5%;"><a style="margin:0;" value='+(g+1)+" type=3>第"+(10*d+1)+"-"+a.count+"期</a></li>":1==e&&(f+='<li><a style="margin:0;" value='+(g+1)+" type=3>第"+(10*d+1)+"-"+a.count+"期</a></li>"),$(".page-list").html(f),$(".page-list li").on("click",function(){var a=$(this).find("a").attr("value"),b=$(this).find("a").attr("type");$(this).parent().find("a").removeClass("selected"),$(this).find("a").addClass("selected"),m(b,a,c)})},l=function(b,c){$.each(b,function(a,b){b.content=b.sub_name,b.question=h.changeDate(b.update_time),1==c&&(b.id=b.id+"&weixin=1")});var d=a.template("J_temp-item",{list:b});$("#J_list-box").html(d)},m=function(a,b,c){d.getRequest({url:BEME.APIURL+"/ip/mikaPage",data:{type:a,page:b},successfn:function(a){f.loaded(),0===a.code&&l(a.data.list.reverse(),c)}})},n=function(a,b){d.getLocalRequest({url:BEME.APIURL+"/ip/mikaIndex?type="+a,successfn:function(a){f.loaded(),0===a.code&&j(a.data,b)}}),d.getLocalRequest({url:BEME.APIURL+"/ip/mikaPage",data:{page:0},successfn:function(a){f.loaded(),0===a.code&&k(a.data,b,!1)}})};h.changeDate=function(a){var b=new Date(a),c=b.getMonth()+1+"月"+b.getDate()+"日 ";return c};var o=function(a){$(".share_weixin").on("click",function(){e.shareToWeixin(a,"ip","ipindex")})};h.init=function(){f.setTitle("米卡分龄教育");var a=b.getParams();n(a.type,a.weixin),f.hideAllBox(),o(a.type)},h.uninit=function(){$("#play-music").off("click")}});