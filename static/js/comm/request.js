/*! 09-05-2016 */
define("comm/request",["comm/utils","helper/app","require","exports"],function(a,b,c,d){"use strict";d.hookSuccess=function(){};var e={};d.addGlobalRequestHook=function(a,b){b?e[a]=b:delete e[a]};var f=function(a,b){d.hookSuccess(a,b),$.each(e,function(c,d){d(a,b)})};d.getRequest=function(a){return a=a||{},a.url?(a.xhrFields={withCredentials:!0},a.success=function(b){if(a.successfn){var c=b?$.parseJSON(b):{};a.successfn(c),f(c,a)}},a.timeout=45e3,a.error=function(a,c,d){b.loadingFail()},$.ajax(a)):void 0};var g=function(a,b){var c=$.parseJSON(a);return b.successfn(c,{from:"local"}),f(c,b),c},h=function(a,b){return g(a,b)};d.getLocalRequest=function(c){if(c=c||{},c.url){c.name=c.name||c.url;var d=a.cache.get(c.name);d&&c.successfn&&h(d,c),c.success=function(b){if(b){var e=null;e=d&&d==b||!c.successfn?$.parseJSON(b):h(b,c),e&&0==e.code&&d!=b&&c.name&&a.cache.set(c.name,b)}},c.xhrFields={withCredentials:!0},c.timeout=45e3,c.error=function(a,c,d){b.loadingFail()},d?setTimeout(function(){$.ajax(c)},100):$.ajax(c)}},d.getScript=function(a,b){var c=document.createElement("script");c.async="async",c.src=a,b&&(c.onload=b),document.getElementsByTagName("head")[0].appendChild(c)}});