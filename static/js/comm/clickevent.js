/*! 09-05-2016 */
define("comm/clickevent",["comm/url","comm/pushsong","comm/request","helper/playerbar","helper/app","page/myalbum","require","exports"],function(a,b,c,d,e,f,g,h){"use strict";h.audition=function(a,b){var c=$(b).parent(),e=c.attr("sid"),f=$(".select-all").css("display"),g=$(".delete-all");void 0===f||""===f||"none"===f&&0===g.length||"none"===f&&"none"===g.css("display")?d.initPlayer(c,a[+e]):h.checkbox_all(c)},h.check=function(a){var b=$(a).parent();h.checkbox_all(b)},h.initSelectAllEvent=function(a){$(".select-all").on("click",".left,.title",function(){var a=$(this).parent(),b=a.find(".left").attr("value"),c=$(".item").find(".checkbox");0==+b?(a.find("img").attr("src","./static/images/xuanze.png"),a.find(".left").attr("value",1),$.each(c,function(a,b){$(b).find("img").attr("src","./static/images/xuanze.png"),$(b).attr("value",1)}),$("#add").removeClass("content_add"),$("#add").addClass("content"),$("#delete").removeClass("content_add"),$("#delete").addClass("content")):(a.find("img").attr("src","./static/images/xuanzekong.png"),a.find(".left").attr("value",0),$.each(c,function(a,b){$(b).find("img").attr("src","./static/images/xuanzekong.png"),$(b).attr("value",0)}),$("#add").removeClass("content"),$("#add").addClass("content_add"),$("#delete").removeClass("content"),$("#delete").addClass("content_add"))}),$(".select-all").on("click","#cancel",function(){$("."+a).show(),$(".select-all").hide(),$(".item").find(".checkbox").hide(),$(".item").find(".checkbox span").length&&($(".item").find(".checkbox").show(),$(".item").find(".checkbox span").show(),$(".item").find(".checkbox img").hide())}),$(".select-all").on("click","#add",function(){var b=$(".item"),c=[],d=[],e=[];$.each(b,function(a,b){var f=$(b),g=f.find(".checkbox").attr("value");1===+g&&(c.push(f.attr("sid")),d.push(f.attr("tag")),e.push(f.attr("tagval")))}),f.showAddMyablumBox(c.join(","),d.join(","),e.join(","),a)})},h.playEdit=function(a){("none"===$(".item").find(".checkbox")[0].style.display||""===$(".item").find(".checkbox")[0].style.display)&&($("."+a).hide(),$(".select-all").show(),$(".item").find(".checkbox").show(),$(".item").find(".checkbox span").length&&($(".item").find(".checkbox span").hide(),$(".item").find(".checkbox img").show()))},h.pushSong=function(a){var a=$(a).parent(),c=(a.attr("sid"),$(".select-all").css("display")),d=$(".delete-all");if(!$(".select-all").length||""===c||"none"===c&&0===d.length||"none"===c&&"none"===d.css("display")){var e=["url","md5","type","tag","tagval","size"],f={};$.each(e,function(b,c){f[c]=a.attr(c)});var g=$.extend({},f);g.bid=f.tagval,g.fid=a.attr("sid"),b.playMusic(f,g);var i=document.title,j=$(a).find(".title").text();(""==j||null==j)&&(j=$(a).find(".name").text());var k=h.findName();_czc.push(["_trackEvent","歌曲推送数","歌曲推送数","歌曲推送数"]),_czc.push(["_trackEvent",i,k,j])}else h.checkbox_all(a)},h.pushAllSong=function(a){if(0==$(".item-a").filter(".play-btn").attr("value")){$(".item-a").filter(".play-btn").attr("value",1);var a=$(a).parent().parent().find(".item"),c=["url","md5","type","tag","tagval","size"],d=[],e=[],f=[],g=[],i=0;if($.each(a,function(a,b){var g={};$.each(c,function(a,c){g[c]=$(b).attr(c)}),d.push(g);var h=$.extend({},g);h.bid=g.tagval,h.fid=$(b).attr("sid"),e.push(h),f.push($(b).find(".title").text())}),e.length>10){i=Math.ceil(e.length/10);for(var j=0;i>j;j++)g.push(e.slice(10*j,10*(j+1)));$.each(g,function(a,c){b.playAllMusic(c,c)})}else b.playAllMusic(d,e);var k=document.title,l=h.findName();_czc.push(["_trackEvent","全部播放",l,"全部播放"]),$.each(f,function(a,b){_czc.push(["_trackEvent","歌曲推送数","歌曲推送数","歌曲推送数"]),_czc.push(["_trackEvent",k,l,b])})}},h.pushSongLi=function(a){var a=$(a),c=(a.attr("sid"),["url","md5","type","tag","tagval","size"]),d={};$.each(c,function(b,c){d[c]=a.attr(c)});var e=$.extend({},d);e.bid=d.tagval,e.fid=a.attr("sid"),b.playMusic(d,e);var f=document.title,g=$(a).find(".title").text(),i=h.findName();_czc.push(["_trackEvent","歌曲推送数","歌曲推送数","歌曲推送数"]),_czc.push(["_trackEvent",f,i,g])},h.findName=function(){var a=document.title,b="";switch(a){case"电台":b=$(document).find(".name-box").find(".name").text();break;case"专辑":b=$(document).find(".info-box").find(".title").text();break;case"专题":b=$(document).find(".infotitle").text();break;case"点播排行":b=$(document).find(".menu-list").find(".cur").text();break;case"点播足迹":b="点播足迹";break;default:b="我的听听"}return b},h.newPlayEvent=function(){$("#J_newplay-box").on("click",".btn-cancel",function(){$("#J_newplay-box").hide(),e.hideMask(),$("#play_name").val(""),$("#J_newplay-box .btn-ok").css("color","#acacac")}),$("#J_newplay-box").on("click",".btn-ok",function(){if(null!=$("#play_name").val()&&""!=$("#play_name").val()){var a=$("#play_name").val(),b=$("#play_id").val();return""==b?void c.getRequest({url:BEME.APIURL+"/albums/addPlayList",data:{name:a},type:"POST",successfn:function(a){0===a.code?($("#J_newplay-box").hide(),e.hideMask(),window.location.reload()):(e.showTips("添加失败！"),$("#J_newplay-box").hide(),e.hideMask(),$("#play_name").val(""),$("#J_newplay-box .btn-ok").css("color","#acacac"))}}):void c.getRequest({url:BEME.APIURL+"/albums/editPlayList",data:{name:a,id:b},type:"POST",successfn:function(a){0===a.code?($("#J_newplay-box").hide(),e.hideMask(),window.location.reload()):(e.showTips("添加失败！"),$("#J_newplay-box").hide(),e.hideMask(),$("#play_name").val(""),$("#J_newplay-box .btn-ok").css("color","#acacac"))}})}}),$("#play_name").on("input propertychange",function(){null==$("#play_name").val()||""==$("#play_name").val()?$("#J_newplay-box .btn-ok").css("color","#acacac"):$("#J_newplay-box .btn-ok").css("color","#0091ff")})},h.checkbox_all=function(a){var b=a.find(".checkbox").attr("value");if(0==+b){$(a.find(".checkbox")).find("img").attr("src","./static/images/xuanze.png"),a.find(".checkbox").attr("value","1");var c=$(".item").find(".checkbox"),d=0,e=!1;$.each(c,function(a,b){0==$(b).attr("value")&&d++,1==$(b).attr("value")&&(e=!0)}),d||($(".delete-all .left").length?($(".delete-all .left img").attr("src","./static/images/xuanze.png"),$(".delete-all .left").attr("value",1),$(".select-all .left img").attr("src","./static/images/xuanze.png"),$(".select-all .left").attr("value",1)):($(".select-all .left img").attr("src","./static/images/xuanze.png"),$(".select-all .left").attr("value",1))),e?($("#add").removeClass("content_add"),$("#add").addClass("content"),$("#delete").removeClass("content_add"),$("#delete").addClass("content")):($("#add").removeClass("content"),$("#add").addClass("content_add"),$("#delete").removeClass("content"),$("#delete").addClass("content_add"))}else{$(a.find(".checkbox")).find("img").attr("src","./static/images/xuanzekong.png"),a.find(".checkbox").attr("value","0");var e=!1,c=$(".item").find(".checkbox");if($.each(c,function(a,b){1==$(b).attr("value")&&(e=!0)}),e?($("#add").removeClass("content_add"),$("#add").addClass("content"),$("#delete").removeClass("content_add"),$("#delete").addClass("content")):($("#add").removeClass("content"),$("#add").addClass("content_add"),$("#delete").removeClass("content"),$("#delete").addClass("content_add")),$(".delete-all .left").length){var f=$(".delete-all .left").attr("value");1==+f&&($(".delete-all .left img").attr("src","./static/images/xuanzekong.png"),$(".delete-all .left").attr("value",0),$(".select-all .left img").attr("src","./static/images/xuanzekong.png"),$(".select-all .left").attr("value",0))}else{var f=$(".select-all .left").attr("value");1==+f&&($(".select-all .left img").attr("src","./static/images/xuanzekong.png"),$(".select-all .left").attr("value",0))}}},h.shareToWeixin=function(a,b,d,e){c.getRequest({url:BEME.APIURL+"/weixin/getWeixinJosn",data:{id:a,type:b,album_type:d,album_id:e},successfn:function(a){0==a.code&&window.bemetoy.socialShareWithContent(a.data)}})}});